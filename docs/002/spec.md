## 유스케이스: 코스 탐색 및 수강신청 (수강생)

### 주 액터
수강생 (등록된 사용자)

### 전제 조건
- 사용자는 등록되어 있고 수강생으로 로그인함
- 사용자는 유효한 세션 토큰으로 인증을 성공함
- 사용자는 약관에 동의함

### 트리거
수강생이 수강 가능한 강의를 검색하고 탐색하기 위해 코스 카탈로그 페이지에 접근함

### 주요 시나리오
1. 수강생이 코스 카탈로그 페이지로 이동함
2. 수강생이 검색어, 필터(카테고리, 난이도), 정렬 옵션(최신순/인기순)을 적용함
3. 시스템이 게시된 코스 중 일치하는 항목을 검색하여 표시함
4. 수강생이 상세 정보를 보기 위해 코스 하나를 선택함
5. 시스템이 설명, 요구사항, 일정 등을 포함한 코스 상세 정보를 보여줌
6. 수강생이 "수강신청" 버튼을 클릭함
7. 시스템이 다음 사항을 검증함:
   - 코스가 `게시` 상태인지
   - 수강생이 해당 코스에 이미 등록되지 않았는지
8. 시스템이 데이터베이스에 수강 신청 기록을 생성함
9. 시스템이 수강생에게 수강신청 성공을 확인함
10. 코스가 수강생의 대시보드/내 코스 목록에 나타남

### 예외 시나리오
- **게시되지 않은 코스**: 시스템은 "수강신청이 가능한 코스가 아닙니다"라는 오류 메시지를 표시함
- **중복 수강신청 시도**: 시스템은 여러 번 등록하지 못하게 막고 "이미 등록된 코스입니다" 메시지를 표시함
- **코스 정원 초과**: 정원이 있으면 "코스가 정원 초과입니다" 메시지를 표시함
- **세션 만료**: 인증이 만료되면 수강생을 로그인 페이지로 리디렉션함
- **네트워크 오류**: 시스템은 적절한 오류 메시지를 표시하고 재시도를 허용함

### 비즈니스 규칙
- `게시` 상태인 코스만 수강신청이 가능함
- 수강생은 동일한 코스를 여러 번 수강신청할 수 없음
- 수강신청은 사용자와 코스를 연결하는 수강신청 테이블에 기록을 생성함
- 수강생은 검색 조건과 필터에 맞는 게시된 코스만 볼 수 있음

### 시퀀스 다이어그램
@startuml
title 코스 탐색 및 수강신청

actor "수강생" as User
component "프론트엔드" as FE
component "백엔드" as BE
database "데이터베이스" as DB

User -> FE: 코스 카탈로그로 이동
FE -> BE: GET /api/courses (필터, 검색, 정렬 파라미터 포함)
BE -> DB: 필터가 적용된 게시된 코스 쿼리
DB -> BE: 일치하는 코스 반환
BE -> FE: 코스 목록 반환
FE -> User: 코스 카탈로그 표시

User -> FE: 상세 정보 보기 위해 코스 선택
FE -> BE: GET /api/courses/{id}
BE -> DB: 게시된 경우 ID로 코스 쿼리
DB -> BE: 코스 상세 정보 반환
BE -> FE: 코스 상세 정보 반환
FE -> User: 코스 상세 정보 표시

User -> FE: "수강신청" 버튼 클릭
FE -> BE: POST /api/enrollments {courseId, userId}
BE -> DB: 기존 수강신청 확인
DB -> BE: 이전 수강신청 없음
BE -> DB: 코스 상태 확인
DB -> BE: 코스가 게시됨
BE -> DB: 수강신청 기록 생성
DB -> BE: 수강신청 생성됨
BE -> FE: 수강신청 성공
FE -> User: 수강신청 확인 표시

@enduml